"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("@contentful/rich-text-types");function t(){t=function(n,t){return new a(n,void 0,t)};var n=RegExp.prototype,e=new WeakMap;function a(n,t,r){var i=new RegExp(n,t);return e.set(i,r||e.get(n)),o(i,a.prototype)}function i(n,t){var r=e.get(t);return Object.keys(r).reduce((function(t,e){return t[e]=n[r[e]],t}),Object.create(null))}return r(a,RegExp),a.prototype.exec=function(t){var e=n.exec.call(this,t);return e&&(e.groups=i(e,this)),e},a.prototype[Symbol.replace]=function(t,r){if("string"==typeof r){var o=e.get(this);return n[Symbol.replace].call(this,t,r.replace(/\$<([^>]+)>/g,(function(n,t){return"$"+o[t]})))}if("function"==typeof r){var a=this;return n[Symbol.replace].call(this,t,(function(){var n=arguments;return"object"!=typeof n[n.length-1]&&(n=[].slice.call(n)).push(i(n,a)),r.apply(this,n)}))}return n[Symbol.replace].call(this,t,r)},t.apply(this,arguments)}function e(){return(e=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n}).apply(this,arguments)}function r(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&o(n,t)}function o(n,t){return(o=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function a(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function i(n,t){return n.split(/\n/g).map((function(n,e){return""+("string"==typeof t?t:t(n,e))+n})).join("\n")}function u(n,t){n.lastIndex=0;var e=n.exec(t);return e?[!0,e.groups||{}]:[!1,{}]}function l(n,t){for(var e,r=function(n,t){var e="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(e)return(e=e.call(n)).next.bind(e);if(Array.isArray(n)||(e=function(n,t){if(n){if("string"==typeof n)return a(n,void 0);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(n,void 0):void 0}}(n))){e&&(n=e);var r=0;return function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n);!(e=r()).done;){var o=u(e.value,t);if(o[0])return o}return[!1,{}]}function c(n,t){return void 0===t&&(t="https"),n.startsWith("//")?t+":"+n:n}var d={__proto__:null,prependLines:i,extractRegExp:u,extractRegExps:l,prependNotEmpty:function(n,t){return n?""+t+n:n},prependUrlProtocol:c},s=function(n){return function(t,e){var r=e.next;return"\n"+"#".repeat(n)+" "+r()+"\n"}},p=function(n,t){return(0,t.next)()};function f(n,e){var r=l([t(/^\[(.+)\](.*)$/,{title:1,content:2}),t(/^(.*)\[(.+)\]$/,{content:1,title:2})],n),o=r[1];return r[0]?"["+o.content+"]("+e+' "'+o.title+'")':"["+n+"]("+e+")"}var y,v,m=((y={})[n.MARKS.BOLD]=function(n){return"**"+n+"**"},y[n.MARKS.ITALIC]=function(n){return"*"+n+"*"},y[n.MARKS.UNDERLINE]=function(n){return"<u>"+n+"</u>"},y[n.MARKS.CODE]=function(n){return"<code>"+n+"</code>"},y),S=((v={})[n.BLOCKS.PARAGRAPH]=function(n,t){var e=t.parent,r=(0,t.next)();return r.length?e?"\n"+r+"\n":"\n\n"+r+"\n\n":""},v[n.BLOCKS.HEADING_1]=s(1),v[n.BLOCKS.HEADING_2]=s(2),v[n.BLOCKS.HEADING_3]=s(3),v[n.BLOCKS.HEADING_4]=s(4),v[n.BLOCKS.HEADING_5]=s(5),v[n.BLOCKS.HEADING_6]=s(6),v[n.BLOCKS.EMBEDDED_ENTRY]=function(n,t){var r,o,a,i,u=n.data.target,l=null==u||null==(r=u.sys)?void 0:r.id,c=null==u||null==(o=u.sys)||null==(a=o.contentType)||null==(i=a.sys)?void 0:i.id,d=t.options,s=x(u,t);if(!0!==s)return d.onModelInvalid&&d.onModelInvalid(u,s||""),"";var p=t.options.renderModels[c];if(!p){if(!t.options.renderModels.fallback)throw new Error("Embedded entry render not defined: type="+c+" id="+l);p=t.options.renderModels.fallback}return"\n\n"+p(u,e({},t,{get contentDataPath(){return l}})).trim()+"\n\n"},v[n.BLOCKS.EMBEDDED_ASSET]=function(n,t){var e=n.data.target,r=t.options.prependUrlProtocol?c(e.fields.file.url):e.fields.file.url;return"\n\n!["+e.fields.title+"]("+r+")\n\n"},v[n.BLOCKS.UL_LIST]=p,v[n.BLOCKS.OL_LIST]=p,v[n.BLOCKS.LIST_ITEM]=function(t,e){var r=e.parent,o=(null==r?void 0:r.nodeType)===n.BLOCKS.OL_LIST?(e.index||0)+1+".":"-",a=(0,e.next)();return a?o+" "+i(a,(function(){return"    "})).trim()+"\n":""},v[n.BLOCKS.QUOTE]=function(n,t){return i((0,t.next)(n.content).trim(),"> ")},v[n.BLOCKS.HR]=function(){return"\n\n---\n\n"},v[n.INLINES.ASSET_HYPERLINK]=function(n,t){var e=t.options,r=String((0,t.next)()).trim(),o=n.data.target;return f(r,e.prependUrlProtocol?c(o.fields.file.url):o.fields.file.url)},v[n.INLINES.ENTRY_HYPERLINK]=function(n,t){var e=n.data.target,r=(0,t.next)();return"<span data-node-type='"+n.nodeType+"' data-sys-id='"+e.sys.id+"'>"+r+"</span>"},v[n.INLINES.EMBEDDED_ENTRY]=function(n){return"<span data-node-type='"+n.nodeType+"' data-sys-id='"+n.data.target.sys.id+"'></span>"},v[n.INLINES.HYPERLINK]=function(n,t){return f(String((0,t.next)()).trim(),n.data.uri)},v.fallback=function(n){return"\n\n\x3c!-- Fallback: type="+n.nodeType+" --\x3e\n\n"},v),b=function(n,t){var e,r,o,a,i=(null==n||null==(e=n.sys)?void 0:e.id)||"unknown",u=(null==n||null==(r=n.sys)||null==(o=r.contentType)||null==(a=o.sys)?void 0:a.id)||"unknown",l=t.options.modelFallbackComponentName,c=n.fields;return c?"<"+l+" type='"+u+"' sys-id='"+i+"' :fields='"+(0,t.addContentData)(c,t.contentDataPath)+"'></"+l+">":"<"+l+" type='"+u+"' sys-id='"+i+"' :fields='{}'></"+l+">"},E={__proto__:null,marks:m,blocks:S,modelRenderFallback:b};function x(n,t){var e=t.options,r=function(n){var t,e,r;return n?null!=n&&null!=(t=n.sys)&&null!=(e=t.contentType)&&null!=(r=e.sys)&&r.id?!!Object.prototype.hasOwnProperty.call(n,"fields")||"fields is empty":"cannot detect content type":"entry is empty"}(n);return!0!==r||e.modelValidate&&(r=e.modelValidate(n)),r}var O={contentDataName:"contentData",prependUrlProtocol:!0,modelFallbackComponentName:"RichtextModel",onModelInvalid:function(n,t){var e,r,o,a,i=(null==n||null==(e=n.sys)?void 0:e.id)||"unknown",u=(null==n||null==(r=n.sys)||null==(o=r.contentType)||null==(a=o.sys)?void 0:a.id)||"unknown";console.warn("Entry is invalid: sysId="+i+" type="+u+" reason="+t)}};Object.defineProperty(exports,"BLOCKS",{enumerable:!0,get:function(){return n.BLOCKS}}),Object.defineProperty(exports,"INLINES",{enumerable:!0,get:function(){return n.INLINES}}),Object.defineProperty(exports,"MARKS",{enumerable:!0,get:function(){return n.MARKS}}),exports.asModelRender=function(n){return n},exports.documentToMarkdown=function t(r,o){if(void 0===o&&(o={}),!r||!r.content)return{content:""};var a=e({},O,o,{renderNode:e({},S,o.renderNode),renderMark:e({},m,o.renderMark),renderModels:e({fallback:b},o.renderModels||{})}),i={addContentData:function(n,t){return i.contentData||(i.contentData={}),i.contentData[t]=n,a.contentDataName+"."+t},combineContentData:function(n){Object.entries(n).forEach((function(n){return i.addContentData(n[1],n[0])}))},next:function(){return""},embedDocument:function(n,r){var o=t(n,e({},a,r||{}));return o.contentData&&i.combineContentData(o.contentData),o.content},options:a},u=function t(r,o){return r.map((function(r,a){return function(r,o){var a=o.options;if(n.helpers.isText(r)){var i=r.value;return r.marks.length>0?r.marks.reduce((function(n,t){var e=a.renderMark[t.type];return e?e(n,r):n}),i):i}var u=r.nodeType;if(!u)return"";var l=a.renderNode[u]||a.renderNode.fallback;return l?l(r,e({},o,{next:function(n){return t(n||r.content,e({},o,{parent:r}))}})):""}(r,e({},o,{index:a}))})).join("")}(r.content,i);return u=u.replace(/^\n{2,}/gm,"\n"),i.contentData?{contentData:i.contentData,content:u}:{content:u}},exports.helpers=d,exports.renders=E,exports.validateEntry=x;
//# sourceMappingURL=contentful-rich-text-to-markdown.cjs.production.min.js.map
